{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/atian/Desktop/github-search/src/components/SearchPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { gql, useQuery } from \"@apollo/client\";\nimport { GET_LIST } from \"../graphql/graphql\";\nimport List from \"./List\";\nimport SearchBar from \"./SearchBar\";\nimport Loading from \"./loading/Loading\";\nimport ErrorMessage from \"./error/ErrorMessage\";\nconst GET_REPOSITORIES_LIST = gql`\n  query getRepositoryQuery(\n    $username: String!\n    $after: String\n    $limit: Int!\n  ) {\n    search(\n      query: $username\n      first: $limit\n      after: $after\n      type: REPOSITORY\n    ) {\n      pageInfo {\n        startCursor\n        hasNextPage\n        endCursor\n      }\n      edges {\n        node {\n          ... on Repository {\n            name\n            url\n            description\n            stargazers {\n              totalCount\n            }\n\n            updatedAt\n          }\n        }\n      }\n    }\n  }\n`;\n\nconst SearchPage = () => {\n  _s();\n\n  const [userName, setUserName] = useState(\"\");\n  const {\n    loading,\n    error,\n    data,\n    fetchMore\n  } = useQuery(GET_REPOSITORIES_LIST, {\n    variables: {\n      username: userName,\n      limit: 10\n    }\n  });\n\n  const handleSearch = str => {\n    setUserName(str);\n    fetchMore({\n      variables: {\n        username: str //limit: 10,\n\n      },\n      updateQuery: (prev, {\n        fetchMoreResult\n      }) => {\n        if (!fetchMoreResult) return prev;\n        return fetchMoreResult;\n      }\n    });\n  };\n\n  const handleMore = () => {\n    fetchMore({\n      variables: {\n        username: userName,\n        after: data.search.pageInfo.endCursor //limit: 10,\n\n      },\n      updateQuery: (prev, {\n        fetchMoreResult\n      }) => {\n        if (!fetchMoreResult) return prev;\n        return Object.assign({}, prev, { ...fetchMoreResult,\n          search: { ...fetchMoreResult.search,\n            edges: [...prev.search.edges, ...fetchMoreResult.search.edges]\n          }\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"repository-page\",\n    children: [loading && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 19\n    }, this), error && /*#__PURE__*/_jsxDEV(ErrorMessage, {\n      error: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }, this), !loading && /*#__PURE__*/_jsxDEV(SearchBar, {\n      onSearch: handleSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 20\n    }, this), data && /*#__PURE__*/_jsxDEV(List, {\n      list: data.search.edges,\n      onLoadMore: handleMore,\n      hasNextPage: data.search.pageInfo.hasNextPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SearchPage, \"k6tZtTFkFY/LuAAD7fnhDy4f3vo=\", false, function () {\n  return [useQuery];\n});\n\n_c = SearchPage;\nexport default SearchPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"SearchPage\");","map":{"version":3,"sources":["/Users/atian/Desktop/github-search/src/components/SearchPage.js"],"names":["React","useState","gql","useQuery","GET_LIST","List","SearchBar","Loading","ErrorMessage","GET_REPOSITORIES_LIST","SearchPage","userName","setUserName","loading","error","data","fetchMore","variables","username","limit","handleSearch","str","updateQuery","prev","fetchMoreResult","handleMore","after","search","pageInfo","endCursor","Object","assign","edges","hasNextPage"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\n\nimport { gql, useQuery } from \"@apollo/client\";\nimport {GET_LIST} from \"../graphql/graphql\";\n\nimport List from \"./List\";\nimport SearchBar from \"./SearchBar\";\n\nimport Loading from \"./loading/Loading\";\n\nimport ErrorMessage from \"./error/ErrorMessage\";\n\nconst GET_REPOSITORIES_LIST = gql`\n  query getRepositoryQuery(\n    $username: String!\n    $after: String\n    $limit: Int!\n  ) {\n    search(\n      query: $username\n      first: $limit\n      after: $after\n      type: REPOSITORY\n    ) {\n      pageInfo {\n        startCursor\n        hasNextPage\n        endCursor\n      }\n      edges {\n        node {\n          ... on Repository {\n            name\n            url\n            description\n            stargazers {\n              totalCount\n            }\n\n            updatedAt\n          }\n        }\n      }\n    }\n  }\n`;\n\nconst SearchPage = () => {\n  const [userName, setUserName] = useState(\"\");\n  const { loading, error, data, fetchMore } = useQuery(GET_REPOSITORIES_LIST, {\n    variables: { username: userName, limit: 10 },\n  });\n\n  const handleSearch = (str) => {\n    setUserName(str);\n    fetchMore({\n      variables: {\n        username: str,\n        //limit: 10,\n      },\n      updateQuery: (prev, { fetchMoreResult }) => {\n        if (!fetchMoreResult) return prev;\n        return fetchMoreResult;\n      },\n    });\n  };\n\n  const handleMore = () => {\n    fetchMore({\n      variables: {\n        username: userName,\n        after: data.search.pageInfo.endCursor,\n        //limit: 10,\n      },\n      updateQuery: (prev, { fetchMoreResult }) => {\n        if (!fetchMoreResult) return prev;\n        return Object.assign({}, prev, {\n          ...fetchMoreResult,\n          search: {\n            ...fetchMoreResult.search,\n            edges: [...prev.search.edges, ...fetchMoreResult.search.edges],\n          },\n        });\n      },\n    });\n  };\n\n  return (\n    <div className=\"repository-page\">\n      {loading && <Loading />}\n      {error && <ErrorMessage error={error} />}\n      {!loading && <SearchBar onSearch={handleSearch} />}\n      {data && (\n        <List\n          list={data.search.edges}\n          onLoadMore={handleMore}\n          hasNextPage={data.search.pageInfo.hasNextPage}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default SearchPage;\n"]},"metadata":{},"sourceType":"module"}